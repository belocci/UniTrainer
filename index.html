<!--
UNI TRAINER
Copyright (c) 2026 [Vagif Hasanov]

This work was created by [Vagif Hasanov] via - contracting AI tools
as implementation assistants. All creative direction,
architecture, design, and business logic are original
works of [Vagif Hasanov].

AI was used as a tool under direction, similar to
how a developer uses a compiler or IDE.
-->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Uni Trainer - AI Training</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="v2-theme.css">
</head>
<body>
    <!-- Splash Screen -->
    <div id="splashScreen" class="splash-screen">
        <div class="splash-content">
            <h1 class="splash-title">Uni Trainer</h1>
            <p class="splash-subtitle">AI Training Desktop Application</p>
            <div class="training-mode-selection">
                <div class="training-mode-card" data-mode="local">
                    <h3 class="mode-title">Local Training</h3>
                    <p class="mode-description">Train models using your local GPU. Fast, private, and no internet required. Perfect for development and testing.</p>
                    <div class="mode-features">
                        <span class="feature-tag">Offline</span>
                        <span class="feature-tag">Private</span>
                        <span class="feature-tag">Fast</span>
                    </div>
                </div>
                <div class="training-mode-card" data-mode="cloud">
                    <h3 class="mode-title">Cloud Training</h3>
                    <p class="mode-description">Access powerful cloud GPUs for large-scale training. Scale up resources as needed without hardware limitations.</p>
                    <div class="mode-features">
                        <span class="feature-tag">Scalable</span>
                        <span class="feature-tag">Powerful</span>
                        <span class="feature-tag">Flexible</span>
                    </div>
                </div>
            </div>
            <div class="privacy-notice">
                <span class="privacy-icon">üîí</span>
                <span class="privacy-text">All your data, models, and credentials are stored locally on your device</span>
            </div>
        </div>
    </div>

    <!-- CanopyWave Login Modal -->
    <div id="canopywaveLoginModal" class="login-modal">
        <div class="login-modal-content">
            <div class="login-header">
                <h2 class="login-title">CanopyWave Login</h2>
                <p class="login-subtitle">Enter your API credentials to access cloud training</p>
            </div>
            <div class="login-form">
                <div class="form-group">
                    <label for="apiKeyInput" class="form-label">API Key</label>
                    <input type="password" id="apiKeyInput" class="form-input" placeholder="Enter your CanopyWave API key" autocomplete="off">
                    <div class="form-help">
                        <a href="#" id="helpLink" class="help-link">Where do I find my API key?</a>
                    </div>
                </div>
                <div class="login-privacy-note">
                    <span class="privacy-icon-small">üîí</span>
                    <span class="privacy-text-small">Your API key is encrypted and stored securely on your device</span>
                </div>
                <div id="loginError" class="login-error" style="display: none;"></div>
                <div class="login-actions">
                    <button id="cancelLoginBtn" class="btn btn-ghost">Cancel</button>
                    <button id="submitLoginBtn" class="btn btn-primary">Connect</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Cloud Configuration Modal -->
    <div id="cloudConfigModal" class="login-modal">
        <div class="login-modal-content" style="max-width: 700px;">
            <div class="login-header">
                <h2 class="login-title">Cloud Configuration</h2>
                <p class="login-subtitle">Configure your cloud training instance</p>
            </div>
            
            <div class="login-form">
                <div class="form-group">
                    <label for="cloudProjectSelect" class="form-label">
                        Project
                        <span class="label-help">Your CanopyWave project</span>
                    </label>
                    <select id="cloudProjectSelect" class="setting-select">
                        <option value="">Loading projects...</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="cloudRegionSelect" class="form-label">
                        Region
                        <span class="label-help">Choose closest for best performance</span>
                    </label>
                    <select id="cloudRegionSelect" class="setting-select" disabled>
                        <option value="">Select project first</option>
                    </select>
                    <div class="form-help">
                        <span class="privacy-text-small">üí° Recommended: seq (Seattle), nyc (New York), lon (London)</span>
                    </div>
                </div>
                <div class="form-group">
                    <label for="cloudGPUSelect" class="form-label">
                        GPU Type
                        <span class="label-help">Balance speed and cost</span>
                    </label>
                    <select id="cloudGPUSelect" class="setting-select" disabled>
                        <option value="">Select project first</option>
                    </select>
                    <div class="form-help">
                        <span class="privacy-text-small">üí° Choose based on your budget and performance needs</span>
                    </div>
                </div>
                <div class="form-group">
                    <label for="cloudImageSelect" class="form-label">
                        OS Image
                        <span class="label-help">Operating system with GPU drivers</span>
                    </label>
                    <select id="cloudImageSelect" class="setting-select" disabled>
                        <option value="">Select GPU type first</option>
                    </select>
                    <div class="form-help">
                        <span class="privacy-text-small">üí° Recommended: GPU-Ubuntu.22.04 (includes CUDA drivers)</span>
                    </div>
                </div>
                <div class="form-group">
                    <label for="cloudInstancePassword" class="form-label">
                        Instance Password
                        <span class="label-help">For SSH access</span>
                    </label>
                    <input type="password" id="cloudInstancePassword" class="form-input" placeholder="Create a secure password (min 8 characters)" />
                    <div class="form-help">
                        <span id="passwordRequirements" class="privacy-text-small">üîí Required for SSH access. Use a strong password with letters, numbers, and symbols.</span>
                    </div>
                </div>
                <div class="form-group">
                    <label for="cloudMaxTrainingHours" class="form-label">
                        Max Training Time (Hours)
                        <span class="label-help">Safety limit</span>
                    </label>
                    <input type="number" id="cloudMaxTrainingHours" class="form-input" placeholder="24" value="24" min="0.5" max="168" step="0.5" />
                    <div class="form-help">
                        <span class="privacy-text-small">‚è±Ô∏è Instance auto-terminates after this time to prevent runaway costs</span>
                    </div>
                </div>
                <div class="form-group">
                    <label for="cloudBudgetLimit" class="form-label">
                        Budget Limit ($)
                        <span class="label-help">Warning threshold (not a hard limit)</span>
                    </label>
                    <input type="number" id="cloudBudgetLimit" class="form-input" placeholder="100" value="100" min="1" step="1" />
                    <div class="form-help">
                        <span class="privacy-text-small">üí∞ You'll be warned if costs exceed this amount. Note: Provider will still charge upfront authorization even if it exceeds this limit.</span>
                    </div>
                </div>
                <div id="cloudCostEstimate" class="form-help" style="margin-top: 8px; font-weight: 500; color: #5A4A3A;">
                    Estimated cost: $0.00
                </div>
                <div id="cloudUpfrontWarning" class="form-help" style="margin-top: 8px; font-weight: 500; color: #D32F2F; display: none;">
                    ‚ö†Ô∏è Provider may charge up to $0.00 (24 hours) up front and refund unused time.
                </div>
                <div id="cloudConfigError" class="login-error" style="display: none;"></div>
                <div class="login-actions">
                    <button id="cancelCloudConfigBtn" class="btn btn-ghost">Cancel</button>
                    <button id="confirmCloudConfigBtn" class="btn btn-primary" disabled>Continue</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Main App (initially hidden) -->
    <div id="mainApp" class="app-container hidden">
        <div id="notification" class="notification">
            <span class="notification-icon">‚úì</span>
            <span class="notification-text">Action Successful</span>
            <button class="notification-close" onclick="hideNotification()">√ó</button>
        </div>
        <div class="title-bar">
            <div class="title-bar-drag"></div>
            <div id="balanceDisplay" class="balance-display" style="display: none;">
                <span class="balance-label">Balance:</span>
                <span id="balanceAmount" class="balance-amount">$0.00</span>
            </div>
            <button id="closeBtn" class="title-bar-btn close-btn" title="Close">√ó</button>
        </div>
        <div class="content-wrapper">
            <div class="left-panel">
            <header class="header">
                <h1>UNI TRAINER</h1>
                <p class="subtitle">AI Training Control</p>
            </header>

            <main class="main-content">
                <div class="system-info card">
                    <h2>System</h2>
                    <div class="info-grid">
                        <div class="info-item">
                            <span class="label">CPU:</span>
                            <span class="value">
                                <span id="cpu-info">Detecting...</span>
                                <canvas id="cpuSparkline" class="sparkline-canvas" width="60" height="20"></canvas>
                            </span>
                        </div>
                        <div class="info-item">
                            <span class="label">GPU:</span>
                            <span class="value">
                                <span id="gpu-info">Detecting...</span>
                                <canvas id="gpuSparkline" class="sparkline-canvas" width="60" height="20"></canvas>
                            </span>
                        </div>
                        <div class="info-item">
                            <span class="label">Memory:</span>
                            <span id="memory-info" class="value">Detecting...</span>
                        </div>
                        <div class="info-item">
                            <span class="label">Status:</span>
                            <span id="status" class="value status-ready">Ready</span>
                        </div>
                    </div>
                    <button id="refreshBtn" class="btn btn-ghost">
                        <span class="refresh-icon">‚Üª</span>
                        <span class="refresh-text">Refresh</span>
                    </button>
                </div>

                <!-- Cloud Training Configuration (shown when cloud mode is selected) -->
                <div id="cloudConfigSection" class="card" style="display: none;">
                    <h2>Cloud Configuration</h2>
                    <div class="setting-group">
                        <div class="setting-header">
                            <label>Project</label>
                        </div>
                        <select id="cloudProjectSelect" class="setting-select">
                            <option value="">Loading projects...</option>
                        </select>
                    </div>
                    <div class="setting-group">
                        <div class="setting-header">
                            <label>Region</label>
                        </div>
                        <select id="cloudRegionSelect" class="setting-select" disabled>
                            <option value="">Select project first</option>
                        </select>
                    </div>
                    <div class="setting-group">
                        <div class="setting-header">
                            <label>GPU Type</label>
                        </div>
                        <select id="cloudGPUSelect" class="setting-select" disabled>
                            <option value="">Select project first</option>
                        </select>
                    </div>
                    <div class="setting-group">
                        <div class="setting-header">
                            <label>OS Image</label>
                        </div>
                        <select id="cloudImageSelect" class="setting-select" disabled>
                            <option value="">Select GPU type first</option>
                        </select>
                    </div>
                    <div class="setting-group">
                        <div class="setting-header">
                            <label>Instance Password</label>
                        </div>
                        <input type="password" id="cloudInstancePassword" class="setting-input" placeholder="Password for SSH access" />
                        <div class="setting-description">Required for SSH access to the training instance</div>
                    </div>
                </div>

                <div class="data-section card">
                    <h2>Training Data</h2>
                    <div style="margin-top: 12px;">
                        <button id="selectFolderBtn" class="btn btn-primary" style="width: 100%;">üìÇ Select Dataset Folder</button>
                    </div>
                    <div id="selectedFolderPath" style="display: none; margin-top: 12px; padding: 12px; background: rgba(247, 243, 237, 0.5); border-radius: 8px; border: 1px solid #D4C9B8;">
                        <div style="font-weight: 600; margin-bottom: 4px; color: #5A4A3A;">Selected folder:</div>
                        <div id="folderPathText" style="color: #8B7355; word-break: break-all; font-size: 13px;"></div>
                    </div>
                </div>

                <!-- Tabular Schema Review Panel (only shown for tabular models) -->
                <div class="schema-review-section card" id="schemaReviewSection" style="display: none;">
                    <h2>Schema Review</h2>
                    <div class="setting-description" style="margin-bottom: 16px;">Review and select columns for training. Uncheck columns you want to exclude.</div>
                    
                    <!-- Warning banner for label-like features -->
                    <div id="labelLikeWarningBanner" style="display: none; margin-bottom: 16px; padding: 12px; background: #FFF3CD; border: 1px solid #FFC107; border-radius: 6px;">
                        <div style="display: flex; justify-content: space-between; align-items: start;">
                            <div style="flex: 1;">
                                <div style="font-weight: 600; color: #856404; margin-bottom: 4px;">‚ö† Warning: Label-like features detected</div>
                                <div id="labelLikeWarningText" style="font-size: 12px; color: #856404; margin-bottom: 8px;"></div>
                                <div style="font-size: 11px; color: #856404; opacity: 0.8;">These columns may cause confusion or data leakage. Continue only if you're certain they should be features.</div>
                            </div>
                            <button id="dismissLabelLikeWarningBtn" class="btn btn-ghost" style="font-size: 11px; padding: 4px 8px; margin-left: 8px;">Continue anyway</button>
                        </div>
                    </div>
                    
                    <div class="setting-group" style="margin-bottom: 20px;">
                        <div class="setting-header">
                            <label>Target Column</label>
                            <span class="setting-help" title="The column to predict">?</span>
                        </div>
                        <select id="targetColumnSelect" class="setting-select">
                            <option value="">Select target column...</option>
                        </select>
                    </div>
                    
                    <div class="setting-group" style="margin-bottom: 16px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                            <div style="display: flex; align-items: center; gap: 12px;">
                                <label style="font-weight: 600; margin: 0;">Feature selection</label>
                                <label style="display: flex; align-items: center; cursor: pointer; font-weight: normal; font-size: 13px; color: #8B7355; margin: 0;">
                                    <input type="checkbox" id="autoExcludeIdColumns" checked style="margin-right: 6px; width: 16px; height: 16px; accent-color: #6B5A4A;">
                                    <span>‚òë Suspected ID columns excluded</span>
                                </label>
                            </div>
                            <div>
                                <button id="selectAllFeaturesBtn" class="btn btn-ghost" style="font-size: 11px; padding: 4px 8px; margin-right: 4px;">Select All</button>
                                <button id="deselectAllFeaturesBtn" class="btn btn-ghost" style="font-size: 11px; padding: 4px 8px;">Deselect All</button>
                            </div>
                        </div>
                        <div style="font-size: 11px; color: #8B7355; opacity: 0.7; margin-left: 0; margin-top: 4px;">Applies to feature columns only</div>
                        <div id="featureColumnsList" style="max-height: 400px; overflow-y: auto; border: 1px solid #E0D5C7; border-radius: 8px; padding: 12px; background: #FAF8F4;">
                            <div style="color: #8B7355; font-size: 13px; text-align: center; padding: 20px;">Select a CSV file to review schema</div>
                        </div>
                    </div>
                </div>

                <div class="model-purpose-section card" id="modelPurposeSection" style="display: block;">
                    <h2>Model Configuration</h2>
                    <div class="setting-group">
                        <div class="setting-header">
                            <label>Model Type</label>
                            <span class="setting-help" title="Select what the model will be used for">?</span>
                        </div>
                        <div class="setting-description">Choose the type of task this model will perform</div>
                        <select id="modelPurposeInput" class="setting-select">
                            <option value="computer_vision">Computer Vision - Image classification, object detection, etc.</option>
                            <option value="machine_learning">Machine Learning - General ML tasks, regression, classification</option>
                            <option value="tabular">Tabular Data - Structured data, CSV files, classification & regression</option>
                            <option value="natural_language_processing">Natural Language Processing - Text analysis, language models</option>
                            <option value="reinforcement_learning">Reinforcement Learning - Game AI, robotics, decision making</option>
                            <option value="time_series">Time Series - Forecasting, sequence prediction</option>
                            <option value="generative">Generative Models - GANs, VAEs, text/image generation</option>
                        </select>
                    </div>
                    
                    <div class="setting-group" id="frameworkGroup" style="display: none;">
                        <div class="setting-header">
                            <label>Framework</label>
                            <span class="setting-help" title="Select the machine learning framework">?</span>
                        </div>
                        <div class="setting-description">Choose the framework for this model type</div>
                        <select id="frameworkInput" class="setting-select">
                            <!-- Options populated dynamically -->
                        </select>
                    </div>
                    
                    <div class="setting-group" id="modelVariantGroup" style="display: none;">
                        <div class="setting-header">
                            <label>Model Variant</label>
                            <span class="setting-help" title="Select the specific model architecture">?</span>
                        </div>
                        <div class="setting-description">Choose the model architecture variant ‚≠ê Recommended</div>
                        <select id="modelVariantInput" class="setting-select">
                            <!-- Options populated dynamically -->
                        </select>
                    </div>
                    
                    <div class="setting-group" id="formatGroup" style="display: none;">
                        <div class="setting-header">
                            <label>Model Format</label>
                            <span class="setting-help" title="Select the format to save the trained model">?</span>
                        </div>
                        <div class="setting-description">File format for the saved model</div>
                        <select id="modelFormatInput" class="setting-select">
                            <!-- Options populated dynamically -->
                        </select>
                    </div>
                </div>

                <div class="settings-section card" id="settingsSection" style="display: block;">
                    <h2>Training Settings</h2>
                    
                    <div class="settings-mode-toggle">
                        <button id="presetModeBtn" class="mode-btn active">Preset</button>
                        <button id="manualModeBtn" class="mode-btn">Manual</button>
                    </div>

                    <div id="presetSettings" class="preset-settings">
                        <div class="slider-container">
                            <div class="slider-labels">
                                <span>Speed</span>
                                <span>Quality</span>
                            </div>
                            <div class="slider-wrapper">
                                <input type="range" id="qualitySlider" class="quality-slider" min="0" max="100" value="100">
                                <div class="slider-track"></div>
                                <div class="slider-fill" id="sliderFill"></div>
                                <div class="slider-handle" id="sliderHandle"></div>
                            </div>
                            <div class="preset-info">
                                <span id="presetLabel">Maximum Quality</span>
                                <span id="presetDescription">Best results, longer training time</span>
                            </div>
                        </div>
                        <button id="applyPresetBtn" class="btn btn-primary">Apply Settings</button>
                    </div>

                    <div id="manualSettings" class="manual-settings" style="display: none;">
                        <div class="setting-group">
                            <div class="setting-header">
                                <label>Epochs</label>
                                <span class="setting-help" title="Number of complete passes through the training dataset">?</span>
                            </div>
                            <div class="setting-description">How many times the model sees the entire dataset</div>
                            <select id="epochsInput" class="setting-select">
                                <option value="5">5 - Very Fast (Quick tests)</option>
                                <option value="10">10 - Fast ‚≠ê Recommended</option>
                                <option value="20">20 - Balanced</option>
                                <option value="50">50 - High Quality</option>
                                <option value="100">100 - Maximum Quality</option>
                                <option value="200">200 - Extreme (Very long training)</option>
                            </select>
                        </div>
                        <div class="setting-group">
                            <div class="setting-header">
                                <label>Batch Size</label>
                                <span class="setting-help" title="Number of samples processed before updating model weights">?</span>
                            </div>
                            <div class="setting-description">Samples processed per training step</div>
                            <select id="batchSizeInput" class="setting-select">
                                <option value="8">8 - Very Small (Low memory)</option>
                                <option value="16">16 - Small</option>
                                <option value="32">32 - Medium ‚≠ê Recommended</option>
                                <option value="64">64 - Large</option>
                                <option value="128">128 - Very Large (High memory)</option>
                                <option value="256">256 - Maximum (Requires 16GB+ GPU)</option>
                            </select>
                        </div>
                        <div class="setting-group">
                            <div class="setting-header">
                                <label>Learning Rate</label>
                                <span class="setting-help" title="Step size for weight updates during training">?</span>
                            </div>
                            <div class="setting-description">How quickly the model learns (higher = faster but less stable)</div>
                            <select id="learningRateInput" class="setting-select">
                                <option value="0.0001">0.0001 - Very Conservative</option>
                                <option value="0.0005">0.0005 - Conservative</option>
                                <option value="0.001">0.001 - Standard ‚≠ê Recommended</option>
                                <option value="0.005">0.005 - Aggressive</option>
                                <option value="0.01">0.01 - Very Aggressive</option>
                                <option value="0.1">0.1 - Extreme (May be unstable)</option>
                            </select>
                        </div>
                        <div class="setting-group">
                            <div class="setting-header">
                                <label>Optimizer</label>
                                <span class="setting-help" title="Algorithm that updates model weights during training">?</span>
                            </div>
                            <div class="setting-description">Algorithm used to update model parameters</div>
                            <select id="optimizerInput" class="setting-select">
                                <option value="adam">Adam - Adaptive, works well for most cases ‚≠ê Recommended</option>
                                <option value="adamw">AdamW - Adam with weight decay (better regularization)</option>
                                <option value="sgd">SGD - Simple, good for fine-tuning</option>
                                <option value="rmsprop">RMSprop - Good for recurrent networks</option>
                                <option value="adagrad">AdaGrad - Adaptive gradient (sparse data)</option>
                                <option value="nadam">NAdam - Nesterov-accelerated Adam</option>
                            </select>
                        </div>
                        <div class="setting-group">
                            <div class="setting-header">
                                <label>Loss Function</label>
                                <span class="setting-help" title="Function that measures how far predictions are from actual values">?</span>
                            </div>
                            <div class="setting-description">Measures prediction error during training</div>
                            <select id="lossFunctionInput" class="setting-select">
                                <option value="mse">Mean Squared Error - Regression tasks ‚≠ê Recommended</option>
                                <option value="categorical_crossentropy">Categorical Crossentropy - Multi-class classification</option>
                                <option value="binary_crossentropy">Binary Crossentropy - Binary classification</option>
                                <option value="sparse_categorical_crossentropy">Sparse Categorical - Multi-class (integer labels)</option>
                                <option value="mae">Mean Absolute Error - Regression (robust to outliers)</option>
                                <option value="huber">Huber Loss - Regression (combines MSE & MAE)</option>
                            </select>
                        </div>
                        <div class="setting-group">
                            <div class="setting-header">
                                <label>Validation Split</label>
                                <span class="setting-help" title="Percentage of data reserved for validation">?</span>
                            </div>
                            <div class="setting-description">Fraction of data used for validation (not trained on)</div>
                            <select id="validationSplitInput" class="setting-select">
                                <option value="0.1">10% - More training data</option>
                                <option value="0.2">20% - Standard ‚≠ê Recommended</option>
                                <option value="0.3">30% - More validation data</option>
                                <option value="0.4">40% - High validation (large datasets)</option>
                            </select>
                        </div>
                        <div class="setting-group">
                            <div class="setting-header">
                                <label>Device</label>
                                <span class="setting-help" title="Hardware device to use for training">?</span>
                            </div>
                            <div class="setting-description">Choose GPU for faster training (if available) or CPU</div>
                            <select id="deviceInput" class="setting-select">
                                <option value="auto">Auto - Use GPU if available ‚≠ê Recommended</option>
                                <option value="cpu">CPU - Slower but always available</option>
                                <option value="cuda">GPU (CUDA) - Faster training (requires NVIDIA GPU)</option>
                            </select>
                        </div>
                        
                        <!-- RandomForest-specific settings (hidden by default) -->
                        <div id="randomForestSettings" class="random-forest-settings" style="display: none;">
                            <div class="setting-group">
                                <div class="setting-header">
                                    <label>n_estimators</label>
                                    <span class="setting-help" title="Number of trees in the forest">?</span>
                                </div>
                                <div class="setting-description">Number of trees in the random forest</div>
                                <select id="nEstimatorsInput" class="setting-select">
                                    <option value="50">50 - Fast</option>
                                    <option value="100">100 - Standard ‚≠ê Recommended</option>
                                    <option value="200">200 - High Quality</option>
                                    <option value="500">500 - Maximum Quality</option>
                                </select>
                            </div>
                            <div class="setting-group">
                                <div class="setting-header">
                                    <label>max_depth</label>
                                    <span class="setting-help" title="Maximum depth of the tree">?</span>
                                </div>
                                <div class="setting-description">Maximum depth of each tree (None = unlimited)</div>
                                <select id="maxDepthInput" class="setting-select">
                                    <option value="None">None - Unlimited depth</option>
                                    <option value="5">5 - Shallow</option>
                                    <option value="10">10 - Medium ‚≠ê Recommended</option>
                                    <option value="20">20 - Deep</option>
                                    <option value="30">30 - Very Deep</option>
                                </select>
                            </div>
                            <div class="setting-group">
                                <div class="setting-header">
                                    <label>min_samples_split</label>
                                    <span class="setting-help" title="Minimum samples required to split a node">?</span>
                                </div>
                                <div class="setting-description">Minimum samples required to split an internal node</div>
                                <select id="minSamplesSplitInput" class="setting-select">
                                    <option value="2">2 - Default ‚≠ê Recommended</option>
                                    <option value="5">5 - More conservative</option>
                                    <option value="10">10 - Very conservative</option>
                                </select>
                            </div>
                            <div class="setting-group">
                                <div class="setting-header">
                                    <label>min_samples_leaf</label>
                                    <span class="setting-help" title="Minimum samples required at a leaf node">?</span>
                                </div>
                                <div class="setting-description">Minimum samples required at a leaf node</div>
                                <select id="minSamplesLeafInput" class="setting-select">
                                    <option value="1">1 - Default ‚≠ê Recommended</option>
                                    <option value="2">2 - More conservative</option>
                                    <option value="4">4 - Very conservative</option>
                                </select>
                            </div>
                            <div class="setting-group">
                                <div class="setting-header">
                                    <label>max_features</label>
                                    <span class="setting-help" title="Number of features to consider when looking for the best split">?</span>
                                </div>
                                <div class="setting-description">Number of features to consider for best split</div>
                                <select id="maxFeaturesInput" class="setting-select">
                                    <option value="sqrt">sqrt - Square root of features ‚≠ê Recommended</option>
                                    <option value="log2">log2 - Logarithm base 2 of features</option>
                                    <option value="None">None - All features</option>
                                </select>
                            </div>
                        </div>
                        
                        <button id="applyManualBtn" class="btn btn-primary">Apply Settings</button>
                    </div>
                </div>

                <div class="training-section card">
                    <h2>Training</h2>
                    <div class="controls">
                        <button id="testGpuBtn" class="btn">Test GPU</button>
                        <button id="testCpuBtn" class="btn">Test CPU</button>
                        <button id="startTrainingBtn" class="btn btn-primary">Start Training</button>
                        <button id="stopTrainingBtn" class="btn" disabled>Stop Training</button>
                        <button id="terminateInstanceBtn" class="btn btn-danger" disabled style="margin-left: 8px;">Terminate Instance</button>
                        <button id="trainNewModelBtn" class="btn" style="margin-left: 8px;">Train New Model</button>
                    </div>
                    <div class="output-container">
                        <div id="output" class="output">Ready to start training...</div>
                    </div>
                </div>

                <div class="monitoring card">
                    <h2>Resources</h2>
                    <div class="monitor-grid">
                        <div class="monitor-item">
                            <div class="monitor-label">CPU</div>
                            <div class="progress-bar">
                                <div id="cpu-usage" class="progress-fill" style="width: 0%"></div>
                            </div>
                            <span id="cpu-percent" class="percent">0%</span>
                        </div>
                        <div class="monitor-item">
                            <div class="monitor-label">GPU</div>
                            <div class="progress-bar">
                                <div id="gpu-usage" class="progress-fill" style="width: 0%"></div>
                            </div>
                            <span id="gpu-percent" class="percent">0%</span>
                        </div>
                        <div class="monitor-item">
                            <div class="monitor-label">Memory</div>
                            <div class="progress-bar">
                                <div id="memory-usage" class="progress-fill" style="width: 0%"></div>
                            </div>
                            <span id="memory-percent" class="percent">0%</span>
                        </div>
                    </div>
                </div>

                <div class="model-section card" id="modelSection" style="display: none;">
                    <h2>Saved Model</h2>
                    <div class="model-info">
                        <div class="model-path">
                            <span class="model-label">Location:</span>
                            <span id="modelPath" class="model-path-text"></span>
                        </div>
                        <div class="model-actions" style="display: flex; gap: 8px; margin-top: 12px;">
                            <button id="openModelLocationBtn" class="btn btn-primary">Open File Location</button>
                            <button id="retrainModelBtn" class="btn">Retrain</button>
                        </div>
                    </div>
                </div>

                <div class="load-model-section card" id="loadModelSection">
                    <h2>Load Model / Continue Training</h2>
                    <div class="model-browser">
                        <button id="refreshModelsBtn" class="btn" style="margin-bottom: 12px;">Refresh Model List</button>
                        <div id="modelsList" class="models-list">
                            <div class="model-item-empty">No saved models found. Train a model to see it here.</div>
                        </div>
                    </div>
                </div>

                <!-- CV Inference Section -->
                <div class="inference-section card" id="cvInferenceSection" style="display: none;">
                    <h2>üîç CV Inference</h2>
                    <div class="setting-group">
                        <div class="setting-header">
                            <label>Model</label>
                        </div>
                        <select id="cvModelSelect" class="setting-select">
                            <option value="">Loading models...</option>
                        </select>
                        <div class="setting-description">Default: Last run best.pt</div>
                    </div>
                    <div class="setting-group">
                        <div class="setting-header">
                            <label>Input Image</label>
                        </div>
                        <button id="selectCvImageBtn" class="btn btn-primary" style="width: 100%;">üì∑ Upload Image</button>
                        <div id="cvImagePath" style="display: none; margin-top: 8px; padding: 8px; background: #FAF8F4; border: 1px solid #E0D5C7; border-radius: 6px; font-size: 12px; color: #8B7355; word-break: break-all;"></div>
                    </div>
                    <div class="setting-group">
                        <div class="setting-header">
                            <label>Confidence Threshold</label>
                            <span id="cvConfidenceValue" style="margin-left: 8px; color: #8B7355; font-weight: 600;">0.25</span>
                        </div>
                        <input type="range" id="cvConfidenceSlider" min="0" max="1" step="0.05" value="0.25" class="setting-slider">
                        <div class="setting-description">Detections below this confidence will be filtered out</div>
                    </div>
                    <div class="setting-group">
                        <button id="runCvInferenceBtn" class="btn btn-primary" style="width: 100%;" disabled>Run Inference</button>
                    </div>
                    <div id="cvInferenceResults" style="display: none; margin-top: 16px;">
                        <div class="setting-group">
                            <div class="setting-header">
                                <label>Preview</label>
                            </div>
                            <div id="cvPreviewContainer" style="max-width: 100%; max-height: 400px; overflow: auto; border: 1px solid #E0D5C7; border-radius: 6px; padding: 8px; background: #FAF8F4;">
                                <img id="cvPreviewImage" style="max-width: 100%; height: auto; display: block;" />
                            </div>
                        </div>
                        <div class="setting-group">
                            <div class="setting-header">
                                <label>Detections</label>
                            </div>
                            <div id="cvDetectionsList" style="max-height: 200px; overflow-y: auto; border: 1px solid #E0D5C7; border-radius: 6px; padding: 12px; background: #FAF8F4; font-size: 12px;">
                                <!-- Detections will be populated here -->
                            </div>
                        </div>
                        <div class="setting-group">
                            <button id="openCvOutputFolderBtn" class="btn btn-ghost" style="width: 100%;">üìÇ Open Output Folder</button>
                        </div>
                    </div>
                </div>

                <!-- Tabular Inference Section -->
                <div class="inference-section card" id="tabularInferenceSection" style="display: none;">
                    <h2>üîç Tabular Inference</h2>
                    <div class="setting-group">
                        <div class="setting-header" style="display: flex; justify-content: space-between; align-items: center;">
                            <label>Model</label>
                            <button id="refreshTabularModelsBtn" class="btn btn-ghost" style="font-size: 11px; padding: 4px 8px;">üîÑ Refresh</button>
                        </div>
                        <select id="tabularModelSelect" class="setting-select">
                            <option value="">Loading models...</option>
                        </select>
                        <div class="setting-description">Select a trained tabular model artifact</div>
                    </div>
                    <div class="setting-group">
                        <div class="setting-header">
                            <label>Input CSV</label>
                        </div>
                        <button id="selectTabularCsvBtn" class="btn btn-primary" style="width: 100%;">üìä Upload CSV</button>
                        <div id="tabularCsvPath" style="display: none; margin-top: 8px; padding: 8px; background: #FAF8F4; border: 1px solid #E0D5C7; border-radius: 6px; font-size: 12px; color: #8B7355; word-break: break-all;"></div>
                    </div>
                    <div class="setting-group">
                        <button id="runTabularInferenceBtn" class="btn btn-primary" style="width: 100%;" disabled>Run Inference</button>
                    </div>
                    <div id="tabularInferenceResults" style="display: none; margin-top: 16px;">
                        <div class="setting-group">
                            <div class="setting-header">
                                <label>Predictions Preview</label>
                            </div>
                            <div id="tabularResultsTable" style="max-height: 400px; overflow: auto; border: 1px solid #E0D5C7; border-radius: 6px; padding: 12px; background: #FAF8F4;">
                                <!-- Results table will be populated here -->
                            </div>
                        </div>
                        <div class="setting-group">
                            <button id="exportTabularPredictionsBtn" class="btn btn-primary" style="width: 100%;">üíæ Export predictions.csv</button>
                        </div>
                    </div>
                </div>

            </main>
        </div>

            <div class="right-panel">
                <div class="neural-header">
                    <div style="display: flex; align-items: center; justify-content: space-between; width: 100%;">
                        <h2 class="neural-title">Neural Connections</h2>
                        <div id="trainingStatusIndicator" class="training-status-indicator">
                            <span class="status-dot"></span>
                            <span class="status-text">Ready</span>
                        </div>
                    </div>
                    <div class="neural-metrics">
                        <div class="metrics-tabs">
                            <button id="simpleMetricsTab" class="metric-tab active">Simple</button>
                            <button id="detailedMetricsTab" class="metric-tab">Detailed</button>
                        </div>
                        
                        <div class="north-star-metric">
                            <div class="metric-label">Training Progress</div>
                            <div id="northStarValue" class="metric-value">--</div>
                        </div>
                        
                        <!-- Simple Metrics View -->
                        <div id="simpleMetricsView" class="secondary-metrics">
                            <div class="metric-item">
                                <span id="epochLabel" class="metric-label-small">Epoch</span>
                                <div class="metric-value-container">
                                    <span id="currentEpoch" class="metric-value-small">--</span>
                                </div>
                            </div>
                            <div class="metric-item">
                                <span class="metric-label-small">Parameters</span>
                                <div class="metric-value-container">
                                    <span id="parameterCount" class="metric-value-small">--</span>
                                </div>
                            </div>
                            <div class="metric-item">
                                <span class="metric-label-small">ETA</span>
                                <div class="metric-value-container">
                                    <span id="eta" class="metric-value-small">--</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Detailed Metrics View -->
                        <div id="detailedMetricsView" class="secondary-metrics" style="display: none;">
                            <div class="metric-item">
                                <span class="metric-label-small">Box Loss</span>
                                <div class="metric-value-container">
                                    <span id="boxLoss" class="metric-value-small">--</span>
                                </div>
                            </div>
                            <div class="metric-item">
                                <span class="metric-label-small">Cls Loss</span>
                                <div class="metric-value-container">
                                    <span id="clsLoss" class="metric-value-small">--</span>
                                </div>
                            </div>
                            <div class="metric-item">
                                <span class="metric-label-small">DFL Loss</span>
                                <div class="metric-value-container">
                                    <span id="dflLoss" class="metric-value-small">--</span>
                                </div>
                            </div>
                            <div class="metric-item">
                                <span class="metric-label-small">GPU Mem</span>
                                <div class="metric-value-container">
                                    <span id="gpuMem" class="metric-value-small">--</span>
                                </div>
                            </div>
                            <div class="metric-item">
                                <span class="metric-label-small">Instances</span>
                                <div class="metric-value-container">
                                    <span id="instances" class="metric-value-small">--</span>
                                </div>
                            </div>
                            <div class="metric-item">
                                <span class="metric-label-small">Speed</span>
                                <div class="metric-value-container">
                                    <span id="processingSpeed" class="metric-value-small">--</span>
                                </div>
                            </div>
                            <div class="metric-item">
                                <span class="metric-label-small">mAP@0.5</span>
                                <div class="metric-value-container">
                                    <span id="map50" class="metric-value-small">--</span>
                                </div>
                            </div>
                            <div class="metric-item">
                                <span class="metric-label-small">mAP@0.5:0.95</span>
                                <div class="metric-value-container">
                                    <span id="map5095" class="metric-value-small">--</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="visualization-container">
                    <canvas id="neuralCanvas"></canvas>
                    <canvas id="trainingChart" class="training-chart"></canvas>
                    <div id="chartTooltip" class="chart-tooltip"></div>
                    <div id="validationMessage" class="validation-message" style="display: none;">
                        <div class="scanning-text">Validating Model Performance</div>
                        <div class="status-pulse"></div>
                    </div>
                </div>
                <div id="neuralTooltip" class="neural-tooltip"></div>
            </div>
        </div>
    </div>

    <!-- Training Loading Overlay -->
    <div id="trainingLoadingOverlay" class="training-loading-overlay" style="display: none;">
        <div class="training-loading-content">
            <div class="training-loading-spinner"></div>
            <h3>Preparing Training</h3>
            <p id="loadingStatusText">Initializing model and verifying dataset...</p>
            <div class="loading-progress-bar">
                <div class="loading-progress-fill"></div>
            </div>
        </div>
    </div>

    <script src="neural-network.js"></script>
    <script src="renderer.js"></script>
    <script>
        // Inline script to ensure splash screen works - MUST be global
        // This runs AFTER renderer.js loads
        // Don't override if renderer.js version exists (it handles cloud mode)
        const originalShowMainApp = window.showMainApp;
        if (originalShowMainApp && originalShowMainApp.toString().includes('selectedMode')) {
            console.log('renderer.js showMainApp detected, preserving it');
            // renderer.js version exists, don't override
        } else {
            // Fallback inline version (only if renderer.js version doesn't exist)
            window.showMainApp = function(selectedMode = 'local') {
                console.log('showMainApp called from inline script (fallback)');
            const splashScreen = document.getElementById('splashScreen');
            const mainApp = document.getElementById('mainApp');
            
            console.log('splashScreen:', splashScreen);
            console.log('mainApp:', mainApp);
            
            if (!splashScreen || !mainApp) {
                console.error('Elements not found!');
                return;
            }
            
            // Hide splash screen
            splashScreen.style.display = 'none';
            splashScreen.classList.add('hidden');
            splashScreen.style.visibility = 'hidden';
            console.log('Splash hidden');
            
            // Show main app
            mainApp.classList.remove('hidden');
            mainApp.style.display = 'flex';
            mainApp.style.visibility = 'visible';
            mainApp.style.opacity = '1';
            console.log('Main app shown');
            
            // Wait for scripts to load, then initialize
            function waitAndInitialize() {
                // Check if renderer.js functions are loaded
                if (typeof loadSystemInfo === 'function' && typeof setupFileUpload === 'function') {
                    // Functions are loaded, initialize
                    if (typeof window.initializeApp === 'function') {
                        try {
                            window.initializeApp();
                        } catch (e) {
                            console.error('Error in initializeApp:', e);
                        }
                    } else {
                        // Manual initialization
                        if (typeof loadSystemInfo === 'function') {
                            loadSystemInfo().catch(e => console.error('Error loading system info:', e));
                        }
                        if (typeof setupFileUpload === 'function') setupFileUpload();
                        if (typeof setupSettings === 'function') setupSettings();
                        
                        // Attach button listeners
                        const refreshBtn = document.getElementById('refreshBtn');
                        if (refreshBtn && typeof loadSystemInfo === 'function') {
                            refreshBtn.onclick = loadSystemInfo;
                        }
                        
                        // Initialize neural network
                        if (typeof NeuralNetwork !== 'undefined') {
                            const canvas = document.getElementById('neuralCanvas');
                            if (canvas && typeof window.neuralNetwork === 'undefined') {
                                window.neuralNetwork = new NeuralNetwork(canvas);
                                neuralNetwork.animate();
                            }
                        }
                    }
                } else {
                    // Functions not loaded yet, wait and retry
                    setTimeout(waitAndInitialize, 100);
                }
            }
            
            // Start waiting for scripts
            waitAndInitialize();
            };
        }
        
        // Attach event listener after DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', function() {
                const btn = document.getElementById('startAppBtn');
                if (btn) {
                    btn.onclick = window.showMainApp;
                    btn.addEventListener('click', window.showMainApp);
                }
            });
        } else {
            // DOM already loaded
            const btn = document.getElementById('startAppBtn');
            if (btn) {
                btn.onclick = window.showMainApp;
                btn.addEventListener('click', window.showMainApp);
            }
        }
    </script>
</body>
</html>
